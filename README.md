# SimpleMailApplication
### `Simple Mail Application combines ASP .Net Core Web API with Blazor WebAssembly App`
## Short description
API uses `MailKit` NuGet package to provide logic for sending emails to specific mail host. 
WebAssembly uses `Blazor Radzen` and `Blazor Toast Notification` to provide user friendly interface.
`Gmail` is used as smtp server.

Sollution schema in `MS Visual Studio` (the most important elements are marked):

![0Schema2](https://github.com/user-attachments/assets/4fea6524-f93a-4a8b-8157-7b9caf9480fe)

#### I Creating projects, combining them and installing NuGet packages
1) [`SimpleMail.Lib`](https://github.com/user-attachments/assets/04710f2c-637e-4487-8fab-f8d204a672a5)
 is a class library which contains `EmailDto.cs` class used as data transfer object in other parts of sollution.
2) [`SimpleMailApp.Api`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/64adc087-4437-4375-91f2-107d4be45a5f) is `ASP .Net Core Web API` part of sollution. `MailKit` NuGet package was installed in this part.
3) [`SimpleMailApp.WebAssembly`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/38dfb658-8bb3-4fa2-9721-5fb0ce899fb2) is `Blazor WebAssembly App` part of sollution. `Radzen.Blazor` and `Blazor.Toast` NuGet packages was installed in this part.
4) [`Combining`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/1c294229-df6e-4dab-9780-b343f5be8afd) Api and WebAssembly parts of sollution.
5) Project reference to `SimpleMail.Lib` added in [`SimpleMailApp.Api`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/eb7923c3-7728-4fbe-8aa5-d7c6a8aeab9b) and in [`SimpleMailApp.WebAssembly`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/5a9d7e44-b28d-4e7f-aec7-c0484096c3f3).

#### II `SimpleMailApp.Api` functionalities
1) [`appsettings.json`](https://github.com/user-attachments/assets/eb48945b-4cfc-4b8b-ba4f-39fc88f454ba) file configured to use specific mail host from `Gmail` service: `EmailHost`, `EmailUsername` and `EmailPassword` added.
2) [`IEmailService.cs`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/cb4e9f76-b519-4cc2-bb20-9e6e0b6881b3) interface created which takes `EmailDto.cs` from `SimpleMail.Lib` as parameter.
3) [`EmailService.cs`](https://github.com/user-attachments/assets/e8cef1b9-a76b-4557-829c-9bd8783f8eae) class which implements `IEmailService` interface created. `IConfiguration` interface injected in class constructor, it allows using configuration from `appsettings.json`. `EmailService` class has only one method called `SendEmail()`. This method takes `EmailDto` as parameter and uses `MailKit` NuGet package features to configure email message, connect with smtp server, send email and disconnect.
4) [`EmailService`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/1030bb8a-7b0f-451c-b144-68de676c5b1f) add for dependency injection in `Program.cs` file.
5) [`EmailController.cs`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/2efd75f7-1cc6-48bd-99c3-193e8c43ca73) created. `EmailService` injected in class constructor. `EmailController` has only one method called `SendEmail` which is a `HttpPost` method. This method takes `EmailDto` as parameter, uses `EmailService` to send emails and returns `Status200OK` when everything goes fine.
#### III `SimpleMailApp.WebAssembly`functionalities
1) [`IEmailService.cs`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/ed2258d4-72e5-414d-873a-48e24a94385f) interface which takes `EmailDto.cs` as parameter created.
2) [`EmailService.cs`](https://github.com/user-attachments/assets/6fc7410d-84c0-40f4-838e-4adb7228a3a2) class which implements `IEmailService` created. `HttpClient` is injected in class constructor. This class has only one method called `SendEmail()` which takes `EmailDto` as parameter. This method uses `HttpClient` to connect with Api part of the project and sends emails when everything is fine.
3) `EmailService`, `Blazor Toast` and `Blazor Radzen` added for dependency injection in [`Program.cs`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/47ec152b-2f42-4188-9441-cc59f64b6265).
4) `Blazor Toast` and `Blazor Radzen` usings addded in [`_Imports.razor`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/bd108632-6554-40e6-a280-e98a8ca26429).
5) In `wwwroot` direcotry in [`index.html`](https://github.com/user-attachments/assets/5f44884a-f14d-4cfb-b81f-4d1c409d2b17) file `FontAwesome` , `Blazor Radzen` and script for 'Chose files' button were added.
6) In [`MainLayout.razor`](https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/89bc5649-261f-4417-8dcd-70ebfac9d5e4) added `Blazor Radzen` on the bottom of the element, `Blazor Toast` configured using `FontAwesome` in `<BlazoredToast>` tag: notifications show for 5s on the top left corner of the website.
7) `EmailSenderBase.cs` class which implements `ComponentBase` class created. `EmailService`, Blazor `ToastService` and `NavigationManager` injected. `EmailSenderBase` class has some properties: `popup` which is a boolean value set as `true` , `model` which is `EmailDto` type, `allowedExtensions` which is a string array containing allowed file extensions and `TotalAttachmentsSizeMB` which is a double represeting size of added files in MB. The class has few methods called: [`SendEmail()`](https://github.com/user-attachments/assets/22b7c841-e3a1-4abd-8353-c2760cd41f37) which checks if email address porvided by user is correct and also if total size of attachments doesn't exceed the limit of 20 MB. When is it correct then it sends email, shows appropriate notification and reloads page, otherwise it only shows error message notification. 
[`OnInputFileChange()`](https://github.com/user-attachments/assets/432f6856-041d-48d7-b944-4e9067493ae0) method checks if user adds ad once max 10 files, if added files have valid extensions, if single file size is max 10 MB and if total files size is max 20 MB, the method uses `GetMultipleFiles` method to add files to email attachments (files are based on `EmailAttachmentsDto`), if something is wrong it sends user a notification. [`TriggerFileInput()` , `RemoveAttachment()` , `RemoveAllAttachments()` and `IsValidEmail`](https://github.com/user-attachments/assets/0ed4645e-408e-44a6-8b9c-67e16abd154b) methods responsibilities are: open file selection dialog (the built-in button has been replaced with its own 'Choose File' button), removes single attachment on 'x' click, removes all attachments on 'DELETE ALL' button click and checks format of email addres provided by user.
8) [`EmailSender.razor`](https://github.com/user-attachments/assets/bad1fc15-c9a8-456f-a951-8d6033c5fddd) component created. It inherits from `EmailSenderBase` class and contains `Blazor Radzen` components. It provides user friendly interface and also some logic.
#### IV `SimpleMailApplication` in action
1) [`SimpleMailApp.Api`](https://github.com/user-attachments/assets/96a19d86-0563-4bc7-af7d-e1d1adf32041) part which could be desplayed and used in Internet Browser using `Swaagger`.
2) [`Email Sender`]([https://github.com/jpurgat95/SimpleMailApplication/assets/94840984/7e80be35-5001-4f4f-bd0b-c299ac30cdf9](https://github.com/user-attachments/assets/9becd008-d6a7-40f4-88a2-56c346e5f930)) page view: three text fields: email addres, email subject and email message, `Choose Files` and `Send Email` buttons.
3) `Blazor Radzen` in action: [`wrong email addres`](https://github.com/user-attachments/assets/fcc65a80-1fce-4022-9db4-9a6e04739fbb), [`empty email address`](https://github.com/user-attachments/assets/56c79651-667c-4e3e-bda6-0de4b903478e).
4) `Blazor Toast Notification` in action after `Choose files` button click: [`too many files added ad once`](https://github.com/user-attachments/assets/bbfbc076-af01-4910-b684-7976a83e96ee), 
[`extension doesn't allowed`](https://github.com/user-attachments/assets/dc0f4bf2-a2ed-4aad-8b2c-4f9cc188b180), [`file size exceeds 10 MB`](https://github.com/user-attachments/assets/d138da05-a637-4b07-a59d-b583622dc933) , [`total file size exceeds 20 MB`](https://github.com/user-attachments/assets/6ebbbeea-cb64-4bd7-a042-5efe204c034e).
5) `Blazor Toast Notification` in action after `Send Email` button click: [`empty email addressd`](https://github.com/user-attachments/assets/aa23fb8c-f664-40ce-bd51-2aa138d74f19), [`wrong email address format`](https://github.com/user-attachments/assets/8f290017-40b8-4166-a258-9342a8507dff), [`correct email address format`](https://github.com/user-attachments/assets/a2600f79-5974-415b-b25a-5c696c8f4e61).
6) [`Sent message`](https://github.com/user-attachments/assets/e3e6a42e-28f9-4cbe-aece-e390c81125a2), [`message recipient's inbox view`](https://github.com/user-attachments/assets/8b7eb9ea-4ead-4dbf-943c-a85132b5e8d7) and Gmail Account used by application [`outbox view`](https://github.com/user-attachments/assets/2b5a4882-e51e-4705-bcf2-4bbdb6494f2d).
